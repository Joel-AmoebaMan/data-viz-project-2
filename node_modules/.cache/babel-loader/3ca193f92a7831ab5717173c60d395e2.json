{"ast":null,"code":"var _jsxFileName = \"/Users/spaul/dev/london/my-app/src/D3.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { Paper } from '@mui/material';\nimport React, { useEffect, useRef, useState } from 'react';\nimport * as d3 from \"d3\";\nimport Streets from './assets/streets.json';\nimport Pumps from './assets/pumps.json';\nimport Deaths from './assets/deaths.json';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction useWindowSize() {\n  _s();\n\n  // Initialize state with undefined width/height so server and client renders match\n  // Learn more here: https://joshwcomeau.com/react/the-perils-of-rehydration/\n  const [windowSize, setWindowSize] = useState({\n    width: 0,\n    height: 0\n  });\n  useEffect(() => {\n    // Handler to call on window resize\n    function handleResize() {\n      // Set window width/height to state\n      setWindowSize({\n        width: window.innerWidth,\n        height: window.innerHeight\n      });\n    } // Add event listener\n\n\n    window.addEventListener(\"resize\", handleResize); // Call handler right away so state gets updated with initial window size\n\n    handleResize(); // Remove event listener on cleanup\n\n    return () => window.removeEventListener(\"resize\", handleResize);\n  }, []); // Empty array ensures that effect is only run on mount\n\n  return windowSize;\n}\n\n_s(useWindowSize, \"0a3DBxaDyAKKz3AdK3zyWcmkePQ=\");\n\nconst margin = {\n  top: 10,\n  right: 30,\n  bottom: 30,\n  left: 60\n};\n\nconst D3 = () => {\n  _s2();\n\n  const [height, setHeight] = useState(700);\n  const [width, setWidth] = useState(800);\n  const paperRef = useRef();\n  const d3Ref = useRef(d3.selectAll(\"#paper-plane svg g\"));\n  const windowSize = useWindowSize();\n  let streets;\n  let pumps;\n  let deaths;\n  let xScale = d3.scaleLinear().domain([0, 20]).range([0, width - margin.left - margin.right]);\n  let yScale = d3.scaleLinear().domain([0, 20]).range([height - margin.top - margin.bottom, 0]);\n  useEffect(() => createMap(), []);\n  useEffect(() => {\n    paperRef.current = document.getElementById(\"paper-plane\");\n\n    if (paperRef.current) {\n      xScale = d3.scaleLinear().domain([0, 20]).range([0, paperRef.current.clientWidth - margin.left - margin.right]);\n      yScale = d3.scaleLinear().domain([0, 20]).range([paperRef.current.clientHeight - margin.top - margin.bottom, 0]);\n      setHeight(paperRef.current.clientHeight);\n      setWidth(paperRef.current.clientWidth);\n    }\n  }, [windowSize.width, windowSize.height]);\n\n  const createMap = () => {\n    d3Ref.current = d3.selectAll(\"#paper-plane svg g\"); // .call(d3.zoom().on(\"zoom\", function (e) {\n    //     console.log(e)\n    //     console.log(d3.event)\n    //     div.attr(\"transform\", d3.event.transform)\n    // }));\n\n    d3Ref.current.attr(\"width\", width).attr(\"height\", height).append(\"g\"); // streets\n\n    streets = d3Ref.current.selectAll('polygon').data(Streets).enter().append(\"polygon\").style(\"stroke\", \"gray\").style(\"fill\", \"gray\").style(\"stroke-width\", 6).attr(\"points\", d => {\n      let points = \"\";\n      d.forEach((_, i) => points += `${xScale(d[i].x)}, ${yScale(d[i].y)} `);\n      return points;\n    });\n    console.log(streets);\n    const tooltip = d3.select(\"#tooltip\").append(\"div\").style(\"position\", \"absolute\").style(\"visibility\", \"hidden\").style(\"padding\", \"3px\").style(\"background\", \"gray\").text(\"\"); //pumps\n\n    pumps = d3Ref.current.selectAll('circle').data(Pumps).enter().append('circle').style(\"fill\", \"deepskyblue\").style(\"r\", 8).attr(\"cx\", d => xScale(d.x)).attr(\"cy\", d => yScale(d.y));\n    deaths = d3Ref.current.selectAll('text').data(Deaths).enter().append(\"circle\").style(\"fill\", \"red\").style(\"r\", 2).attr(\"cx\", d => xScale(d.x)).attr(\"cy\", d => yScale(d.y)).style(\"cursor\", \"pointer\").on(\"mouseover\", d => tooltip.style(\"visibility\", \"visible\").text(`Age: ${d.age}`)).on(\"mousemove\", d => {\n      return tooltip.style(\"top\", yScale(d.y) - 15 + \"px\").style(\"left\", xScale(d.x) + 15 + \"px\");\n    });\n  };\n\n  useEffect(() => {\n    // d3Ref.current = d3Ref.current.remove();\n    console.log(streets); // streets.attr(\"points\", (d:any) => {\n    //     let points = \"\";\n    //     d.forEach((_:any, i: number) => points += `${xScale(d[i].x)}, ${yScale(d[i].y)} `);\n    //     return points;\n    // });\n  }, [height, width]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Paper, {\n      id: \"paper-plane\",\n      sx: {\n        p: 2,\n        display: 'flex',\n        flexDirection: 'column',\n        height: '80vh'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"svg\", {\n        height: \"100%\",\n        children: /*#__PURE__*/_jsxDEV(\"g\", {\n          height: \"100%\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 5\n    }, this)\n  }, void 0, false);\n};\n\n_s2(D3, \"hkTEdpGYe/YcB9l11Rsgbu3BFDQ=\", false, function () {\n  return [useWindowSize];\n});\n\n_c = D3;\nexport default D3;\n\nvar _c;\n\n$RefreshReg$(_c, \"D3\");","map":{"version":3,"names":["Paper","React","useEffect","useRef","useState","d3","Streets","Pumps","Deaths","useWindowSize","windowSize","setWindowSize","width","height","handleResize","window","innerWidth","innerHeight","addEventListener","removeEventListener","margin","top","right","bottom","left","D3","setHeight","setWidth","paperRef","d3Ref","selectAll","streets","pumps","deaths","xScale","scaleLinear","domain","range","yScale","createMap","current","document","getElementById","clientWidth","clientHeight","attr","append","data","enter","style","d","points","forEach","_","i","x","y","console","log","tooltip","select","text","on","age","p","display","flexDirection"],"sources":["/Users/spaul/dev/london/my-app/src/D3.tsx"],"sourcesContent":["import { Paper } from '@mui/material';\nimport React, { useEffect, useRef, useState } from 'react';\nimport * as d3 from \"d3\";\nimport Streets from './assets/streets.json';\nimport Pumps from './assets/pumps.json';\nimport Deaths from './assets/deaths.json';\nimport { BaseType } from 'd3';\n\nfunction useWindowSize() {\n    // Initialize state with undefined width/height so server and client renders match\n    // Learn more here: https://joshwcomeau.com/react/the-perils-of-rehydration/\n    const [windowSize, setWindowSize] = useState({\n      width: 0,\n      height: 0,\n    });\n    useEffect(() => {\n      // Handler to call on window resize\n      function handleResize() {\n        // Set window width/height to state\n        setWindowSize({\n          width: window.innerWidth,\n          height: window.innerHeight,\n        });\n      }\n      // Add event listener\n      window.addEventListener(\"resize\", handleResize);\n      // Call handler right away so state gets updated with initial window size\n      handleResize();\n      // Remove event listener on cleanup\n      return () => window.removeEventListener(\"resize\", handleResize);\n    }, []); // Empty array ensures that effect is only run on mount\n    return windowSize;\n}\n\nconst margin = {top: 10, right: 30, bottom: 30, left: 60}\n\nconst D3 = () => {\n    const [height, setHeight] = useState(700);\n    const [width, setWidth] = useState(800);\n    const paperRef = useRef<HTMLElement | null>();\n    const d3Ref = useRef(d3.selectAll(\"#paper-plane svg g\"));\n    const windowSize = useWindowSize();\n    let streets: d3.Selection<d3.BaseType, unknown, d3.BaseType, unknown>;\n    let pumps: d3.Selection<d3.BaseType, unknown, d3.BaseType, unknown>;\n    let deaths: d3.Selection<d3.BaseType, unknown, d3.BaseType, unknown>;\n    let xScale = d3.scaleLinear().domain([0, 20]).range([0, width - margin.left - margin.right]);\n    let yScale = d3.scaleLinear().domain([0, 20]).range([height - margin.top - margin.bottom, 0]);\n\n    useEffect(()=>createMap(),[]);\n\n    useEffect(() => {\n        paperRef.current = document.getElementById(\"paper-plane\");\n        if (paperRef.current) {\n            xScale = d3.scaleLinear().domain([0, 20]).range([0, paperRef.current.clientWidth - margin.left - margin.right]);\n            yScale = d3.scaleLinear().domain([0, 20]).range([paperRef.current.clientHeight - margin.top - margin.bottom, 0]);\n            setHeight(paperRef.current.clientHeight);\n            setWidth(paperRef.current.clientWidth);\n        }\n    },[windowSize.width, windowSize.height])\n\n    const createMap = () => {\n        \n        \n        d3Ref.current = d3.selectAll(\"#paper-plane svg g\")\n        // .call(d3.zoom().on(\"zoom\", function (e) {\n        //     console.log(e)\n        //     console.log(d3.event)\n        //     div.attr(\"transform\", d3.event.transform)\n        // }));\n\n        d3Ref.current\n            .attr(\"width\", width)\n            .attr(\"height\", height)\n            .append(\"g\");\n        \n        // streets\n        streets = d3Ref.current.selectAll('polygon')\n            .data(Streets)\n            .enter()\n            .append(\"polygon\")\n            .style(\"stroke\", \"gray\")\n            .style(\"fill\", \"gray\")\n            .style(\"stroke-width\", 6)\n            .attr(\"points\", d => {\n                let points = \"\";\n                d.forEach((_, i) => points += `${xScale(d[i].x)}, ${yScale(d[i].y)} `);\n                return points;\n            }) as any;\n            console.log(streets)\n        const tooltip = d3.select(\"#tooltip\")\n            .append(\"div\")\n                .style(\"position\", \"absolute\")\n                .style(\"visibility\", \"hidden\")\n                .style(\"padding\", \"3px\")\n                .style(\"background\", \"gray\")\n                .text(\"\");\n\n        //pumps\n        pumps = d3Ref.current.selectAll('circle')\n            .data(Pumps)\n            .enter()\n            .append('circle')\n            .style(\"fill\", \"deepskyblue\")\n            .style(\"r\", 8)\n            .attr(\"cx\", d => xScale(d.x))\n            .attr(\"cy\", d => yScale(d.y)) as any;\n        \n        deaths = d3Ref.current.selectAll('text')\n            .data(Deaths)\n            .enter()\n            .append(\"circle\")\n            .style(\"fill\", \"red\")\n            .style(\"r\", 2)\n            .attr(\"cx\", d => xScale(d.x))\n            .attr(\"cy\", d => yScale(d.y))\n            .style(\"cursor\", \"pointer\")\n            .on(\"mouseover\", (d) => tooltip.style(\"visibility\", \"visible\").text(`Age: ${d.age}`))\n            .on(\"mousemove\", (d) => {\n                return tooltip.style(\"top\", (yScale(d.y) - 15)+\"px\").style(\"left\",(xScale(d.x) + 15)+\"px\")\n            }) as any\n    }\n\n    useEffect(() => {\n        // d3Ref.current = d3Ref.current.remove();\n        console.log(streets)\n        // streets.attr(\"points\", (d:any) => {\n        //     let points = \"\";\n        //     d.forEach((_:any, i: number) => points += `${xScale(d[i].x)}, ${yScale(d[i].y)} `);\n        //     return points;\n        // });\n        \n    },[height, width]);\n\n    return <>\n    <Paper\n        id=\"paper-plane\"\n        sx={{\n        p: 2,\n        display: 'flex',\n        flexDirection: 'column',\n        height: '80vh',\n    }}>\n        <svg height=\"100%\">\n            <g height=\"100%\">\n            </g>\n        </svg>\n    </Paper>\n    </>;\n}\n\nexport default D3;"],"mappings":";;;;AAAA,SAASA,KAAT,QAAsB,eAAtB;AACA,OAAOC,KAAP,IAAgBC,SAAhB,EAA2BC,MAA3B,EAAmCC,QAAnC,QAAmD,OAAnD;AACA,OAAO,KAAKC,EAAZ,MAAoB,IAApB;AACA,OAAOC,OAAP,MAAoB,uBAApB;AACA,OAAOC,KAAP,MAAkB,qBAAlB;AACA,OAAOC,MAAP,MAAmB,sBAAnB;;;;AAGA,SAASC,aAAT,GAAyB;EAAA;;EACrB;EACA;EACA,MAAM,CAACC,UAAD,EAAaC,aAAb,IAA8BP,QAAQ,CAAC;IAC3CQ,KAAK,EAAE,CADoC;IAE3CC,MAAM,EAAE;EAFmC,CAAD,CAA5C;EAIAX,SAAS,CAAC,MAAM;IACd;IACA,SAASY,YAAT,GAAwB;MACtB;MACAH,aAAa,CAAC;QACZC,KAAK,EAAEG,MAAM,CAACC,UADF;QAEZH,MAAM,EAAEE,MAAM,CAACE;MAFH,CAAD,CAAb;IAID,CARa,CASd;;;IACAF,MAAM,CAACG,gBAAP,CAAwB,QAAxB,EAAkCJ,YAAlC,EAVc,CAWd;;IACAA,YAAY,GAZE,CAad;;IACA,OAAO,MAAMC,MAAM,CAACI,mBAAP,CAA2B,QAA3B,EAAqCL,YAArC,CAAb;EACD,CAfQ,EAeN,EAfM,CAAT,CAPqB,CAsBb;;EACR,OAAOJ,UAAP;AACH;;GAxBQD,a;;AA0BT,MAAMW,MAAM,GAAG;EAACC,GAAG,EAAE,EAAN;EAAUC,KAAK,EAAE,EAAjB;EAAqBC,MAAM,EAAE,EAA7B;EAAiCC,IAAI,EAAE;AAAvC,CAAf;;AAEA,MAAMC,EAAE,GAAG,MAAM;EAAA;;EACb,MAAM,CAACZ,MAAD,EAASa,SAAT,IAAsBtB,QAAQ,CAAC,GAAD,CAApC;EACA,MAAM,CAACQ,KAAD,EAAQe,QAAR,IAAoBvB,QAAQ,CAAC,GAAD,CAAlC;EACA,MAAMwB,QAAQ,GAAGzB,MAAM,EAAvB;EACA,MAAM0B,KAAK,GAAG1B,MAAM,CAACE,EAAE,CAACyB,SAAH,CAAa,oBAAb,CAAD,CAApB;EACA,MAAMpB,UAAU,GAAGD,aAAa,EAAhC;EACA,IAAIsB,OAAJ;EACA,IAAIC,KAAJ;EACA,IAAIC,MAAJ;EACA,IAAIC,MAAM,GAAG7B,EAAE,CAAC8B,WAAH,GAAiBC,MAAjB,CAAwB,CAAC,CAAD,EAAI,EAAJ,CAAxB,EAAiCC,KAAjC,CAAuC,CAAC,CAAD,EAAIzB,KAAK,GAAGQ,MAAM,CAACI,IAAf,GAAsBJ,MAAM,CAACE,KAAjC,CAAvC,CAAb;EACA,IAAIgB,MAAM,GAAGjC,EAAE,CAAC8B,WAAH,GAAiBC,MAAjB,CAAwB,CAAC,CAAD,EAAI,EAAJ,CAAxB,EAAiCC,KAAjC,CAAuC,CAACxB,MAAM,GAAGO,MAAM,CAACC,GAAhB,GAAsBD,MAAM,CAACG,MAA9B,EAAsC,CAAtC,CAAvC,CAAb;EAEArB,SAAS,CAAC,MAAIqC,SAAS,EAAd,EAAiB,EAAjB,CAAT;EAEArC,SAAS,CAAC,MAAM;IACZ0B,QAAQ,CAACY,OAAT,GAAmBC,QAAQ,CAACC,cAAT,CAAwB,aAAxB,CAAnB;;IACA,IAAId,QAAQ,CAACY,OAAb,EAAsB;MAClBN,MAAM,GAAG7B,EAAE,CAAC8B,WAAH,GAAiBC,MAAjB,CAAwB,CAAC,CAAD,EAAI,EAAJ,CAAxB,EAAiCC,KAAjC,CAAuC,CAAC,CAAD,EAAIT,QAAQ,CAACY,OAAT,CAAiBG,WAAjB,GAA+BvB,MAAM,CAACI,IAAtC,GAA6CJ,MAAM,CAACE,KAAxD,CAAvC,CAAT;MACAgB,MAAM,GAAGjC,EAAE,CAAC8B,WAAH,GAAiBC,MAAjB,CAAwB,CAAC,CAAD,EAAI,EAAJ,CAAxB,EAAiCC,KAAjC,CAAuC,CAACT,QAAQ,CAACY,OAAT,CAAiBI,YAAjB,GAAgCxB,MAAM,CAACC,GAAvC,GAA6CD,MAAM,CAACG,MAArD,EAA6D,CAA7D,CAAvC,CAAT;MACAG,SAAS,CAACE,QAAQ,CAACY,OAAT,CAAiBI,YAAlB,CAAT;MACAjB,QAAQ,CAACC,QAAQ,CAACY,OAAT,CAAiBG,WAAlB,CAAR;IACH;EACJ,CARQ,EAQP,CAACjC,UAAU,CAACE,KAAZ,EAAmBF,UAAU,CAACG,MAA9B,CARO,CAAT;;EAUA,MAAM0B,SAAS,GAAG,MAAM;IAGpBV,KAAK,CAACW,OAAN,GAAgBnC,EAAE,CAACyB,SAAH,CAAa,oBAAb,CAAhB,CAHoB,CAIpB;IACA;IACA;IACA;IACA;;IAEAD,KAAK,CAACW,OAAN,CACKK,IADL,CACU,OADV,EACmBjC,KADnB,EAEKiC,IAFL,CAEU,QAFV,EAEoBhC,MAFpB,EAGKiC,MAHL,CAGY,GAHZ,EAVoB,CAepB;;IACAf,OAAO,GAAGF,KAAK,CAACW,OAAN,CAAcV,SAAd,CAAwB,SAAxB,EACLiB,IADK,CACAzC,OADA,EAEL0C,KAFK,GAGLF,MAHK,CAGE,SAHF,EAILG,KAJK,CAIC,QAJD,EAIW,MAJX,EAKLA,KALK,CAKC,MALD,EAKS,MALT,EAMLA,KANK,CAMC,cAND,EAMiB,CANjB,EAOLJ,IAPK,CAOA,QAPA,EAOUK,CAAC,IAAI;MACjB,IAAIC,MAAM,GAAG,EAAb;MACAD,CAAC,CAACE,OAAF,CAAU,CAACC,CAAD,EAAIC,CAAJ,KAAUH,MAAM,IAAK,GAAEjB,MAAM,CAACgB,CAAC,CAACI,CAAD,CAAD,CAAKC,CAAN,CAAS,KAAIjB,MAAM,CAACY,CAAC,CAACI,CAAD,CAAD,CAAKE,CAAN,CAAS,GAAnE;MACA,OAAOL,MAAP;IACH,CAXK,CAAV;IAYIM,OAAO,CAACC,GAAR,CAAY3B,OAAZ;IACJ,MAAM4B,OAAO,GAAGtD,EAAE,CAACuD,MAAH,CAAU,UAAV,EACXd,MADW,CACJ,KADI,EAEPG,KAFO,CAED,UAFC,EAEW,UAFX,EAGPA,KAHO,CAGD,YAHC,EAGa,QAHb,EAIPA,KAJO,CAID,SAJC,EAIU,KAJV,EAKPA,KALO,CAKD,YALC,EAKa,MALb,EAMPY,IANO,CAMF,EANE,CAAhB,CA7BoB,CAqCpB;;IACA7B,KAAK,GAAGH,KAAK,CAACW,OAAN,CAAcV,SAAd,CAAwB,QAAxB,EACHiB,IADG,CACExC,KADF,EAEHyC,KAFG,GAGHF,MAHG,CAGI,QAHJ,EAIHG,KAJG,CAIG,MAJH,EAIW,aAJX,EAKHA,KALG,CAKG,GALH,EAKQ,CALR,EAMHJ,IANG,CAME,IANF,EAMQK,CAAC,IAAIhB,MAAM,CAACgB,CAAC,CAACK,CAAH,CANnB,EAOHV,IAPG,CAOE,IAPF,EAOQK,CAAC,IAAIZ,MAAM,CAACY,CAAC,CAACM,CAAH,CAPnB,CAAR;IASAvB,MAAM,GAAGJ,KAAK,CAACW,OAAN,CAAcV,SAAd,CAAwB,MAAxB,EACJiB,IADI,CACCvC,MADD,EAEJwC,KAFI,GAGJF,MAHI,CAGG,QAHH,EAIJG,KAJI,CAIE,MAJF,EAIU,KAJV,EAKJA,KALI,CAKE,GALF,EAKO,CALP,EAMJJ,IANI,CAMC,IAND,EAMOK,CAAC,IAAIhB,MAAM,CAACgB,CAAC,CAACK,CAAH,CANlB,EAOJV,IAPI,CAOC,IAPD,EAOOK,CAAC,IAAIZ,MAAM,CAACY,CAAC,CAACM,CAAH,CAPlB,EAQJP,KARI,CAQE,QARF,EAQY,SARZ,EASJa,EATI,CASD,WATC,EASaZ,CAAD,IAAOS,OAAO,CAACV,KAAR,CAAc,YAAd,EAA4B,SAA5B,EAAuCY,IAAvC,CAA6C,QAAOX,CAAC,CAACa,GAAI,EAA1D,CATnB,EAUJD,EAVI,CAUD,WAVC,EAUaZ,CAAD,IAAO;MACpB,OAAOS,OAAO,CAACV,KAAR,CAAc,KAAd,EAAsBX,MAAM,CAACY,CAAC,CAACM,CAAH,CAAN,GAAc,EAAf,GAAmB,IAAxC,EAA8CP,KAA9C,CAAoD,MAApD,EAA4Df,MAAM,CAACgB,CAAC,CAACK,CAAH,CAAN,GAAc,EAAf,GAAmB,IAA9E,CAAP;IACH,CAZI,CAAT;EAaH,CA5DD;;EA8DArD,SAAS,CAAC,MAAM;IACZ;IACAuD,OAAO,CAACC,GAAR,CAAY3B,OAAZ,EAFY,CAGZ;IACA;IACA;IACA;IACA;EAEH,CATQ,EASP,CAAClB,MAAD,EAASD,KAAT,CATO,CAAT;EAWA,oBAAO;IAAA,uBACP,QAAC,KAAD;MACI,EAAE,EAAC,aADP;MAEI,EAAE,EAAE;QACJoD,CAAC,EAAE,CADC;QAEJC,OAAO,EAAE,MAFL;QAGJC,aAAa,EAAE,QAHX;QAIJrD,MAAM,EAAE;MAJJ,CAFR;MAAA,uBAQI;QAAK,MAAM,EAAC,MAAZ;QAAA,uBACI;UAAG,MAAM,EAAC;QAAV;UAAA;UAAA;UAAA;QAAA;MADJ;QAAA;QAAA;QAAA;MAAA;IARJ;MAAA;MAAA;MAAA;IAAA;EADO,iBAAP;AAeH,CAhHD;;IAAMY,E;UAKiBhB,a;;;KALjBgB,E;AAkHN,eAAeA,EAAf"},"metadata":{},"sourceType":"module"}